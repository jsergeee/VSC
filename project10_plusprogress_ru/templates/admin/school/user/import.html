{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block content %}
<div id="content-main">
    <div class="module" style="padding: 20px;">
        <h2>Импорт пользователей из Excel</h2>

        <!-- КНОПКА СКАЧИВАНИЯ ШАБЛОНА -->
        <div style="margin-bottom: 20px; text-align: right;">
            <a href="{% url 'download_user_template' %}" class="button" style="background: #17a2b8; color: white; padding: 8px 15px; border: none; border-radius: 4px; text-decoration: none; display: inline-block;">
                <i class="fa fa-download"></i> Скачать шаблон Excel
            </a>
        </div>

        <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
            <h3>Формат файла</h3>
            <p>Excel файл должен содержать следующие колонки:</p>
            <table style="border-collapse: collapse; width: 100%;">
                <thead>
                    <tr style="background: #417690; color: white;">
                        <th style="padding: 8px; border: 1px solid #ddd;">Колонка</th>
                        <th style="padding: 8px; border: 1px solid #ddd;">Описание</th>
                        <th style="padding: 8px; border: 1px solid #ddd;">Пример</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">A</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Username (обязательно)</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">ivanov</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">B</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Имя</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Иван</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">C</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Фамилия</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Иванов</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">D</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Отчество</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Иванович</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">E</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Email</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">ivan@mail.ru</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">F</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Телефон</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">+79991234567</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">G</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Роль</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">student/teacher/admin</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">H</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Пароль</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">password123</td>
                    </tr>
                </tbody>
            </table>
            <p style="margin-top: 10px;">Первая строка должна содержать заголовки колонок.</p>
        </div>

        <form method="post" enctype="multipart/form-data" action="/admin/user/import/">
            {% csrf_token %}
            <div style="margin-bottom: 15px;">
                <label style="font-weight: bold; display: block; margin-bottom: 5px;">Выберите файл Excel:</label>
                <input type="file" name="import_file" accept=".xlsx,.xls" required style="padding: 5px;">
            </div>

            <div style="margin-top: 20px;">
                <button type="submit" name="apply" class="button" style="background: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">
                    <i class="fa fa-upload"></i> Загрузить и импортировать
                </button>
                <a href="{% url 'admin:school_user_changelist' %}" class="button" style="background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 4px; text-decoration: none; margin-left: 10px;">
                    Отмена
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}